## Анализ данных с помощью сценариев “ЧТО-ЕСЛИ”

Полезное видео, чтобы понять что они вообще нахрен делают: [youtube](https://www.youtube.com/watch?v=eEux_vOZ-e4) (первые 4 минуты)

Если коротко, то сценарии позволяет изменять данные, которые находятся в таблице **"нажатием одной кнопки *"Вывести"* "**



### Упражнение 1 - Создание и просмотр сценария

Открываем диспетчер сценариев: Данные -> Что если -> Диспетчер сценариев

![](https://i.imgur.com/KqxFXhn.png)



Нажимаем *Добавить*. Затем откроется новое окно:

![](https://i.imgur.com/nHmvfCE.png)

Тут следует понимать, что в значении "Изменяемые ячейки" вы вводите данные, которыми хотите манипулировать, так как после того как вы нажмете ОК, откроется следующее окно, где вам предложат ввести данные:

![img](https://i.imgur.com/kRuIFuP.png)

Вводим рандомные данные, главное, чтобы они отличались от исходных.



По инструкции создаем еще два сценария. Я изменял в них поля в "Изменяемые ячейки" и также выбрал другие данные.

Получилось что-то такое:

![img](https://i.imgur.com/JrozUC9.png)



Теперь мы можем манипулировать своими выбранными данными (изменяемые ячейки), выбирая сценарий и нажимая кнопку "Вывести":



*Сценарий "Вариант два"*

![](https://i.imgur.com/NR3TDsv.png)

Сценарий "Вариант исходный"

![img](https://i.imgur.com/8ChFRzw.png)



P.S. на самом деле, я в "вариант исходный тоже изменил данные", ну да пох :)

### Упражнение 2 - Merge

*Файл: Ex-2.xlsx*

В этом упражнении нужно просто объединить сценарии с двух разных книг.

Создаем новый xlsx и копируем туда исходные значения. Опять открываем "Диспетчер сценариев" и создаем свой сценарий "Вариант Омега"

![](https://i.imgur.com/fEvmADk.png)

Затем, нас нужно нажать на "Объединить":

![](https://i.imgur.com/iTxx663.png)

Ищем там свою книгу, выбираем оттуда нужный лист и ебашим **ОК**

В итоге получаем их объединение:

![](https://i.imgur.com/36xMSI2.png)



### Упражнение 3 - отчет

Забыл посчитать в прошлых упражнениях ячейку C7. 

Для его подсчета нужно использовать формулу массивов. У меня вышло такое

![img](https://i.imgur.com/7QvDQIK.png)

Чтобы сделать это нужно ввести в ячейку C7 следующий код:

```
=СУММ(B2:B5*C2:C5)
```

Но нажать не просто **Enter**, а **Ctrl + Shift + Enter** чтобы Excel воспринял нашу формулу как формулу массива.

Ну, здесь в "Диспетчер сценариев" выбираем "Отчет". Вылезет окошко, где в ячейке результатов указываем **C7**

![](https://i.imgur.com/3ae09O7.png)

И получаем отчет:

![](https://i.imgur.com/OHDxSmK.png)

### Упражнение 4

Открываем файл Таблица_Подстановки.

Подставляем значения из инструкции в E6 - I6. Выделяем поле: **D6 - I7**.

Теперь в Анализе Данных выбираем Таблица Данных и получаем такое окошко:

![](https://i.imgur.com/nkcpK6G.png)

В поле "... по столбцам" ебашим B6 и получаем следующую поеботу:

![](https://i.imgur.com/ZS2KICI.png)

Если честно, то я так и не понял что мы делаем. Но главное, что-то вообще вывелось :)

К слову, функция ПЛТ:

**ПЛТ** — одна из [финансовых функций](https://support.office.com/ru-ru/article/финансовые-функции-справка-5658d81e-6035-4f24-89c1-fbf124c2b1d8), возвращающая сумму периодического платежа для аннуитета на основе постоянства сумм платежей и постоянной процентной ставки.

**Синтаксис**

ПЛТ (`ставка`; `кпер`; `пс`; `[бс]`; `[тип]`)

Аргументы функции ПЛТ описаны ниже.

- **`Ставка`**    Обязательный аргумент. Процентная ставка по ссуде.
- **`Кпер`**    Обязательный аргумент. Общее число выплат по ссуде.
- **`Пс`**    Обязательный аргумент. Приведенная к текущему моменту стоимость или общая сумма, которая на текущий момент равноценна ряду будущих платежей, называемая также основной суммой.
- **`БС`**    Необязательный аргумент. Будущая стоимость или баланс наличными, которые нужно достичь после последнего платежа. Если аргумент БЗ опущен, то предполагается, что он равен 0 (нулю), то есть будущее значение ссуды равно 0.
- **`Тип`**    Необязательный аргумент. Число 0 (нуль) или 1, обозначающее, когда должна производиться выплата.

Документация: [support.office](https://support.office.com/ru-ru/article/Функция-ПЛТ-0214da64-9a63-4996-bc20-214433fa6441)



В строке формул (**E7-I7**) мы видим формулу массива `{=ТАБЛИЦА(B5;)}`, а не формулы расчета, как в случае с автозаполнением. Что делает ТАБЛИЦА я хз ¯\\_(ツ)__/¯

### Упражнение 5. Два входа

Здесь все делается строго по инструкции без усложнений

![](https://i.imgur.com/oubqhVX.png)



Проверить правильность вычислений можно в двух заранее созданных листах.

